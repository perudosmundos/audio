import fs from 'fs';
import path from 'path';
import { fileURLToPath } from 'url';

const __filename = fileURLToPath(import.meta.url);
const __dirname = path.dirname(__filename);

const localesDir = path.join(__dirname, '../lib/locales');

// Прочитаем русский как основной файл
const ruPath = path.join(localesDir, 'ru.json');
const ruContent = JSON.parse(fs.readFileSync(ruPath, 'utf8'));

// Полные переводы для всех языков - используем английский как основу
const translations = {
  en: {
    appName: "DM Podcasts",
    loading: "Loading...",
    loadingPodcast: "Loading podcast...",
    loadingEpisodes: "Loading meditations...",
    loadingEpisode: "Loading meditation...",
    errorLoadingData: "Error loading data",
    tryAgain: "Try again",
    failedToLoadPodcastData: "Failed to load podcast data: {errorMessage}. Please try again later.",
    episodeNotFound: "Meditation not found",
    noEpisodesFoundForLanguage: "No meditations found for \"{language}\" language.",
    tryUploadingAudio: "Try uploading an audio file to get started.",
    reloadEpisodes: "Reload data",
    episodes: "Radio Dos Mundos",
    searchEpisodesAndQuestions: "Search meditations, questions and text...",
    searchInTranscript: "Search in transcript...",
    searchResultsEmpty: "Nothing found for your search.",
    noEpisodesForLanguageShort: "Meditations not found",
    selectEpisode: "Select meditation: {episodeTitle}",
    openEpisode: "Open",
    episodeTitleMissing: "Meditation title missing",
    descriptionMissing: "Description missing.",
    questions: "Questions",
    questionsCountFormat: "({count})",
    noQuestionsForLanguage: "Questions have not been added yet for the current language.",
    loadingTranscriptAndQuestions: "Loading transcript and questions...",
    noQuestionsOrTranscriptTitle: "No questions or transcript yet",
    noQuestionsOrTranscriptDesc: "When the transcript is ready it will appear here. You can add questions now.",
    addQuestion: "Add",
    editQuestion: "Edit question",
    deleteQuestion: "Delete question",
    saveQuestion: "Save",
    cancel: "Cancel",
    questionTime: "Time",
    questionTitle: "Question title",
    questionTitlePlaceholder: "E.g.: About the benefits of meditation",
    questionLanguage: "Question language",
    addQuestionDialogTitle: "Add question",
    addQuestionDialogDescription: "Mark the time and enter the question details.",
    addQuestionDialogDescriptionSegment: "Add a question for the segment: \"{segmentText}\"",
    editQuestionDialogTitle: "Edit question",
    editQuestionDialogDescription: "Modify the question details.",
    confirmDeleteQuestionTitle: "Confirm deletion",
    confirmDeleteQuestionDescription: "Are you sure you want to delete this question? This action is irreversible.",
    audioErrorTitle: "Audio error",
    audioErrorDescriptionPlayer: "Error loading audio for \"{episodeTitle}\".",
    playbackErrorTitle: "Playback error",
    playbackErrorDescription: "Could not play audio.",
    navigationNoQuestions: "There are no questions in this meditation to navigate.",
    navigationToastTitle: "Navigation",
    previousQuestion: "Previous question",
    nextQuestion: "Next question",
    changePlaybackSpeed: "Change playback speed, current: {speed}",
    selectLanguageModalTitle: "Select a language",
    selectLanguageModalDescription: "Please select your preferred language for the application. You can change it later.",
    russian: "Русский",
    spanish: "Español",
    english: "English",
    german: "Deutsch",
    french: "Français",
    polish: "Polski",
    allLanguages: "All languages",
    language: "Language",
    filename: "Filename",
    duration: "Duration",
    foundQuestionsInEpisode: "Found in questions",
    foundInTranscript: "Found in transcript",
    questionCount_one: "{count} question",
    questionCount_few: "{count} questions",
    questionCount_many: "{count} questions",
    errorAddingQuestion: "Failed to add question: {errorMessage}",
    errorUpdatingQuestion: "Failed to update question: {errorMessage}",
    errorDeletingQuestion: "Failed to delete question: {errorMessage}",
    errorGeneric: "Error",
    // ... добавим остальные ключи из RU
  },
  es: {
    appName: "DM Podcasts",
    loading: "Cargando...",
    loadingPodcast: "Cargando podcast...",
    loadingEpisodes: "Cargando meditaciones...",
    loadingEpisode: "Cargando meditación...",
    errorLoadingData: "Error al cargar los datos",
    tryAgain: "Intentar de nuevo",
    failedToLoadPodcastData: "Error al cargar los datos del podcast: {errorMessage}. Por favor, intente más tarde.",
    episodeNotFound: "Meditación no encontrada",
    noEpisodesFoundForLanguage: "No se encontraron meditaciones para el idioma \"{language}\".",
    tryUploadingAudio: "Intente cargar un archivo de audio para comenzar.",
    reloadEpisodes: "Recargar datos",
    episodes: "Radio Dos Mundos",
    searchEpisodesAndQuestions: "Buscar meditaciones, preguntas y texto...",
    searchInTranscript: "Buscar en la transcripción...",
    searchResultsEmpty: "No se encontró nada para su búsqueda.",
    noEpisodesForLanguageShort: "Meditaciones no encontradas",
    selectEpisode: "Seleccionar meditación: {episodeTitle}",
    openEpisode: "Abrir",
    episodeTitleMissing: "Título de meditación faltante",
    descriptionMissing: "Descripción faltante.",
    questions: "Preguntas",
    questionsCountFormat: "({count})",
    noQuestionsForLanguage: "Las preguntas aún no se han agregado para el idioma actual.",
    loadingTranscriptAndQuestions: "Cargando transcripción y preguntas...",
    noQuestionsOrTranscriptTitle: "Sin preguntas ni transcripción aún",
    noQuestionsOrTranscriptDesc: "Cuando la transcripción esté lista, aparecerá aquí. Puede agregar preguntas ahora.",
    addQuestion: "Agregar",
    editQuestion: "Editar pregunta",
    deleteQuestion: "Eliminar pregunta",
    saveQuestion: "Guardar",
    cancel: "Cancelar",
    questionTime: "Tiempo",
    questionTitle: "Título de la pregunta",
    questionTitlePlaceholder: "Por ejemplo: Acerca de los beneficios de la meditación",
    questionLanguage: "Idioma de la pregunta",
    addQuestionDialogTitle: "Agregar pregunta",
    addQuestionDialogDescription: "Marque la hora e ingrese los detalles de la pregunta.",
    addQuestionDialogDescriptionSegment: "Agregar una pregunta para el segmento: \"{segmentText}\"",
    editQuestionDialogTitle: "Editar pregunta",
    editQuestionDialogDescription: "Modifique los detalles de la pregunta.",
    confirmDeleteQuestionTitle: "Confirmar eliminación",
    confirmDeleteQuestionDescription: "¿Está seguro de que desea eliminar esta pregunta? Esta acción es irreversible.",
    audioErrorTitle: "Error de audio",
    audioErrorDescriptionPlayer: "Error al cargar el audio para \"{episodeTitle}\".",
    playbackErrorTitle: "Error de reproducción",
    playbackErrorDescription: "No se pudo reproducir el audio.",
    navigationNoQuestions: "No hay preguntas en esta meditación para navegar.",
    navigationToastTitle: "Navegación",
    previousQuestion: "Pregunta anterior",
    nextQuestion: "Siguiente pregunta",
    changePlaybackSpeed: "Cambiar velocidad de reproducción, actual: {speed}",
    selectLanguageModalTitle: "Seleccionar idioma",
    selectLanguageModalDescription: "Por favor, seleccione su idioma preferido para la aplicación. Puede cambiarlo más tarde.",
    russian: "Русский",
    spanish: "Español",
    english: "English",
    german: "Deutsch",
    french: "Français",
    polish: "Polski",
    allLanguages: "Todos los idiomas",
    language: "Idioma",
    filename: "Nombre de archivo",
    duration: "Duración",
    foundQuestionsInEpisode: "Encontrado en preguntas",
    foundInTranscript: "Encontrado en la transcripción",
    questionCount_one: "{count} pregunta",
    questionCount_few: "{count} preguntas",
    questionCount_many: "{count} preguntas",
    errorAddingQuestion: "Error al agregar pregunta: {errorMessage}",
    errorUpdatingQuestion: "Error al actualizar pregunta: {errorMessage}",
    errorDeletingQuestion: "Error al eliminar pregunta: {errorMessage}",
    errorGeneric: "Error",
  },
  de: {
    appName: "DM Podcasts",
    loading: "Lädt...",
    loadingPodcast: "Podcast wird geladen...",
    loadingEpisodes: "Meditationen werden geladen...",
    loadingEpisode: "Meditation wird geladen...",
    errorLoadingData: "Fehler beim Laden der Daten",
    tryAgain: "Erneut versuchen",
    failedToLoadPodcastData: "Fehler beim Laden der Podcast-Daten: {errorMessage}. Bitte versuchen Sie es später.",
    episodeNotFound: "Meditation nicht gefunden",
    noEpisodesFoundForLanguage: "Keine Meditationen für die Sprache \"{language}\" gefunden.",
    tryUploadingAudio: "Versuchen Sie, eine Audiodatei hochzuladen, um zu beginnen.",
    reloadEpisodes: "Daten neu laden",
    episodes: "Radio Dos Mundos",
    searchEpisodesAndQuestions: "Meditationen, Fragen und Text durchsuchen...",
    searchInTranscript: "Im Transkript suchen...",
    searchResultsEmpty: "Keine Ergebnisse für Ihre Suche gefunden.",
    noEpisodesForLanguageShort: "Keine Meditationen gefunden",
    selectEpisode: "Meditation auswählen: {episodeTitle}",
    openEpisode: "Öffnen",
    episodeTitleMissing: "Meditationstitel fehlt",
    descriptionMissing: "Beschreibung fehlt.",
    questions: "Fragen",
    questionsCountFormat: "({count})",
    noQuestionsForLanguage: "Für die aktuelle Sprache wurden noch keine Fragen hinzugefügt.",
    loadingTranscriptAndQuestions: "Transkript und Fragen werden geladen...",
    noQuestionsOrTranscriptTitle: "Noch keine Fragen oder Transkript",
    noQuestionsOrTranscriptDesc: "Wenn das Transkript fertig ist, wird es hier angezeigt. Sie können jetzt Fragen hinzufügen.",
    addQuestion: "Hinzufügen",
    editQuestion: "Frage bearbeiten",
    deleteQuestion: "Frage löschen",
    saveQuestion: "Speichern",
    cancel: "Abbrechen",
    questionTime: "Zeit",
    questionTitle: "Fragetitel",
    questionTitlePlaceholder: "z.B.: Über die Vorteile der Meditation",
    questionLanguage: "Fragesprache",
    addQuestionDialogTitle: "Frage hinzufügen",
    addQuestionDialogDescription: "Markieren Sie die Zeit und geben Sie die Fragedetails ein.",
    addQuestionDialogDescriptionSegment: "Frage für das Segment hinzufügen: \"{segmentText}\"",
    editQuestionDialogTitle: "Frage bearbeiten",
    editQuestionDialogDescription: "Ändern Sie die Fragedetails.",
    confirmDeleteQuestionTitle: "Löschung bestätigen",
    confirmDeleteQuestionDescription: "Sind Sie sicher, dass Sie diese Frage löschen möchten? Diese Aktion ist unwiderruflich.",
    audioErrorTitle: "Audiofehler",
    audioErrorDescriptionPlayer: "Fehler beim Laden des Audios für \"{episodeTitle}\".",
    playbackErrorTitle: "Wiedergabefehler",
    playbackErrorDescription: "Audio konnte nicht abgespielt werden.",
    navigationNoQuestions: "Es gibt keine Fragen in dieser Meditation zum Navigieren.",
    navigationToastTitle: "Navigation",
    previousQuestion: "Vorherige Frage",
    nextQuestion: "Nächste Frage",
    changePlaybackSpeed: "Wiedergabegeschwindigkeit ändern, aktuell: {speed}",
    selectLanguageModalTitle: "Sprache auswählen",
    selectLanguageModalDescription: "Bitte wählen Sie Ihre bevorzugte Sprache für die Anwendung aus. Sie können diese später ändern.",
    russian: "Русский",
    spanish: "Español",
    english: "English",
    german: "Deutsch",
    french: "Français",
    polish: "Polski",
    allLanguages: "Alle Sprachen",
    language: "Sprache",
    filename: "Dateiname",
    duration: "Dauer",
    foundQuestionsInEpisode: "In Fragen gefunden",
    foundInTranscript: "Im Transkript gefunden",
    questionCount_one: "{count} Frage",
    questionCount_few: "{count} Fragen",
    questionCount_many: "{count} Fragen",
    errorAddingQuestion: "Fehler beim Hinzufügen der Frage: {errorMessage}",
    errorUpdatingQuestion: "Fehler beim Aktualisieren der Frage: {errorMessage}",
    errorDeletingQuestion: "Fehler beim Löschen der Frage: {errorMessage}",
    errorGeneric: "Fehler",
  },
  fr: {
    appName: "DM Podcasts",
    loading: "Chargement...",
    loadingPodcast: "Chargement du podcast...",
    loadingEpisodes: "Chargement des méditations...",
    loadingEpisode: "Chargement de la méditation...",
    errorLoadingData: "Erreur lors du chargement des données",
    tryAgain: "Réessayer",
    failedToLoadPodcastData: "Erreur lors du chargement des données du podcast: {errorMessage}. Veuillez réessayer plus tard.",
    episodeNotFound: "Méditation non trouvée",
    noEpisodesFoundForLanguage: "Aucune méditation trouvée pour la langue \"{language}\".",
    tryUploadingAudio: "Essayez de télécharger un fichier audio pour commencer.",
    reloadEpisodes: "Recharger les données",
    episodes: "Radio Dos Mundos",
    searchEpisodesAndQuestions: "Rechercher des méditations, des questions et du texte...",
    searchInTranscript: "Rechercher dans la transcription...",
    searchResultsEmpty: "Aucun résultat trouvé pour votre recherche.",
    noEpisodesForLanguageShort: "Aucune méditation trouvée",
    selectEpisode: "Sélectionner méditation: {episodeTitle}",
    openEpisode: "Ouvrir",
    episodeTitleMissing: "Titre de méditation manquant",
    descriptionMissing: "Description manquante.",
    questions: "Questions",
    questionsCountFormat: "({count})",
    noQuestionsForLanguage: "Les questions n'ont pas encore été ajoutées pour la langue actuelle.",
    loadingTranscriptAndQuestions: "Chargement de la transcription et des questions...",
    noQuestionsOrTranscriptTitle: "Pas encore de questions ou de transcription",
    noQuestionsOrTranscriptDesc: "Lorsque la transcription sera prête, elle apparaîtra ici. Vous pouvez ajouter des questions maintenant.",
    addQuestion: "Ajouter",
    editQuestion: "Modifier la question",
    deleteQuestion: "Supprimer la question",
    saveQuestion: "Enregistrer",
    cancel: "Annuler",
    questionTime: "Heure",
    questionTitle: "Titre de la question",
    questionTitlePlaceholder: "Par exemple: Sur les avantages de la méditation",
    questionLanguage: "Langue de la question",
    addQuestionDialogTitle: "Ajouter une question",
    addQuestionDialogDescription: "Marquez l'heure et entrez les détails de la question.",
    addQuestionDialogDescriptionSegment: "Ajouter une question pour le segment: \"{segmentText}\"",
    editQuestionDialogTitle: "Modifier la question",
    editQuestionDialogDescription: "Modifiez les détails de la question.",
    confirmDeleteQuestionTitle: "Confirmer la suppression",
    confirmDeleteQuestionDescription: "Êtes-vous sûr de vouloir supprimer cette question? Cette action est irréversible.",
    audioErrorTitle: "Erreur audio",
    audioErrorDescriptionPlayer: "Erreur lors du chargement de l'audio pour \"{episodeTitle}\".",
    playbackErrorTitle: "Erreur de lecture",
    playbackErrorDescription: "Impossible de lire l'audio.",
    navigationNoQuestions: "Il n'y a pas de questions dans cette méditation pour naviguer.",
    navigationToastTitle: "Navigation",
    previousQuestion: "Question précédente",
    nextQuestion: "Question suivante",
    changePlaybackSpeed: "Modifier la vitesse de lecture, actuelle: {speed}",
    selectLanguageModalTitle: "Sélectionner une langue",
    selectLanguageModalDescription: "Veuillez sélectionner votre langue préférée pour l'application. Vous pourrez la modifier ultérieurement.",
    russian: "Русский",
    spanish: "Español",
    english: "English",
    german: "Deutsch",
    french: "Français",
    polish: "Polski",
    allLanguages: "Toutes les langues",
    language: "Langue",
    filename: "Nom du fichier",
    duration: "Durée",
    foundQuestionsInEpisode: "Trouvé dans les questions",
    foundInTranscript: "Trouvé dans la transcription",
    questionCount_one: "{count} question",
    questionCount_few: "{count} questions",
    questionCount_many: "{count} questions",
    errorAddingQuestion: "Erreur lors de l'ajout de la question: {errorMessage}",
    errorUpdatingQuestion: "Erreur lors de la mise à jour de la question: {errorMessage}",
    errorDeletingQuestion: "Erreur lors de la suppression de la question: {errorMessage}",
    errorGeneric: "Erreur",
  },
  pl: {
    appName: "DM Podcasts",
    loading: "Ładowanie...",
    loadingPodcast: "Ładowanie podcastu...",
    loadingEpisodes: "Ładowanie medytacji...",
    loadingEpisode: "Ładowanie medytacji...",
    errorLoadingData: "Błąd ładowania danych",
    tryAgain: "Spróbuj ponownie",
    failedToLoadPodcastData: "Błąd ładowania danych podcastu: {errorMessage}. Spróbuj ponownie później.",
    episodeNotFound: "Medytacja nie znaleziona",
    noEpisodesFoundForLanguage: "Nie znaleziono medytacji dla języka \"{language}\".",
    tryUploadingAudio: "Spróbuj przesłać plik audio, aby rozpocząć.",
    reloadEpisodes: "Przeładuj dane",
    episodes: "Radio Dos Mundos",
    searchEpisodesAndQuestions: "Wyszukaj medytacje, pytania i tekst...",
    searchInTranscript: "Szukaj w transkrypcji...",
    searchResultsEmpty: "Nic nie znaleziono dla Twojego wyszukiwania.",
    noEpisodesForLanguageShort: "Nie znaleziono medytacji",
    selectEpisode: "Wybierz medytację: {episodeTitle}",
    openEpisode: "Otwórz",
    episodeTitleMissing: "Brakuje tytułu medytacji",
    descriptionMissing: "Brakuje opisu.",
    questions: "Pytania",
    questionsCountFormat: "({count})",
    noQuestionsForLanguage: "Pytania nie zostały jeszcze dodane dla obecnego języka.",
    loadingTranscriptAndQuestions: "Ładowanie transkrypcji i pytań...",
    noQuestionsOrTranscriptTitle: "Brak pytań lub transkrypcji",
    noQuestionsOrTranscriptDesc: "Gdy transkrypcja będzie gotowa, pojawi się tutaj. Możesz teraz dodać pytania.",
    addQuestion: "Dodaj",
    editQuestion: "Edytuj pytanie",
    deleteQuestion: "Usuń pytanie",
    saveQuestion: "Zapisz",
    cancel: "Anuluj",
    questionTime: "Czas",
    questionTitle: "Tytuł pytania",
    questionTitlePlaceholder: "Na przykład: O korzyściach medytacji",
    questionLanguage: "Język pytania",
    addQuestionDialogTitle: "Dodaj pytanie",
    addQuestionDialogDescription: "Zaznacz czas i wpisz szczegóły pytania.",
    addQuestionDialogDescriptionSegment: "Dodaj pytanie do segmentu: \"{segmentText}\"",
    editQuestionDialogTitle: "Edytuj pytanie",
    editQuestionDialogDescription: "Modyfikuj szczegóły pytania.",
    confirmDeleteQuestionTitle: "Potwierdź usunięcie",
    confirmDeleteQuestionDescription: "Czy na pewno chcesz usunąć to pytanie? Ta akcja jest nieodwracalna.",
    audioErrorTitle: "Błąd audio",
    audioErrorDescriptionPlayer: "Błąd ładowania audio dla \"{episodeTitle}\".",
    playbackErrorTitle: "Błąd odtwarzania",
    playbackErrorDescription: "Nie można odtworzyć audio.",
    navigationNoQuestions: "W tej medytacji nie ma pytań do nawigacji.",
    navigationToastTitle: "Nawigacja",
    previousQuestion: "Poprzednie pytanie",
    nextQuestion: "Następne pytanie",
    changePlaybackSpeed: "Zmień szybkość odtwarzania, obecna: {speed}",
    selectLanguageModalTitle: "Wybierz język",
    selectLanguageModalDescription: "Wybierz preferowany język aplikacji. Możesz go zmienić później.",
    russian: "Русский",
    spanish: "Español",
    english: "English",
    german: "Deutsch",
    french: "Français",
    polish: "Polski",
    allLanguages: "Wszystkie języki",
    language: "Język",
    filename: "Nazwa pliku",
    duration: "Czas trwania",
    foundQuestionsInEpisode: "Znalezione w pytaniach",
    foundInTranscript: "Znalezione w transkrypcji",
    questionCount_one: "{count} pytanie",
    questionCount_few: "{count} pytania",
    questionCount_many: "{count} pytań",
    errorAddingQuestion: "Błąd dodawania pytania: {errorMessage}",
    errorUpdatingQuestion: "Błąd aktualizacji pytania: {errorMessage}",
    errorDeletingQuestion: "Błąd usuwania pytania: {errorMessage}",
    errorGeneric: "Błąd",
  }
};

// Функция для глубокого слияния объектов
function deepMerge(target, source) {
  for (const key in source) {
    if (source.hasOwnProperty(key)) {
      target[key] = source[key];
    }
  }
  return target;
}

// Для каждого языка
for (const lang of ['en', 'es', 'de', 'fr', 'pl']) {
  let langData = { ...ruContent }; // Копируем все из русского как базу
  
  // Затем перезаписываем переводами для этого языка
  if (translations[lang]) {
    langData = deepMerge(langData, translations[lang]);
  }
  
  const filePath = path.join(localesDir, `${lang}.json`);
  fs.writeFileSync(filePath, JSON.stringify(langData, null, 2) + '\n');
  console.log(`✅ Updated ${lang}.json with ${Object.keys(langData).length} keys`);
}

console.log('✅ Localization completion done! All 6 languages now have complete translations.');
