# Миграция файлов Hostinger

## Описание
Страница миграции файлов с Hostinger FTP в базу данных Supabase.

## Доступ
Открой в браузере: `http://localhost:5173/hostinger-migration`

## Функции
1. **Просмотр всех файлов** - показывает полный список файлов из папки `/Audio` на Hostinger
2. **Фильтрация по датам** - позволяет фильтровать файлы по конкретным датам
3. **Анализ длительности** - автоматически определяет длительность аудиофайлов
4. **Парсинг названий** - анализирует файлы в формате `YYYY-MM-DD_LANG.mp3`
5. **Проверка существования** - проверяет, есть ли уже такие эпизоды в базе данных
6. **Создание эпизодов** - добавляет новые эпизоды в таблицу `episodes` с длительностью
7. **Создание вопросов** - автоматически создает базовые вопросы для каждого эпизода

## Логика названий файлов
- **С языковым префиксом**: `YYYY-MM-DD_LANG.mp3`
  - Примеры: `2024-01-15_ES.mp3`, `2024-01-15_RU.mp3`
  - Создает slug: `2024-01-15_es`, `2024-01-15_ru`
- **Без языкового префикса**: `YYYY-MM-DD.mp3`
  - Примеры: `2024-01-15.mp3`
  - Создает записи для обоих языков: `2024-01-15_es`, `2024-01-15_ru`

## Создаваемые данные

### Эпизоды
- `slug` - уникальный идентификатор
- `date` - дата эпизода
- `title` - название эпизода (на соответствующем языке)
- `description` - описание (на соответствующем языке)
- `audio_url` - ссылка на файл на Hostinger
- `lang` - язык (es/ru)
- `duration` - длительность в секундах (анализируется автоматически)
- `file_has_lang_suffix` - есть ли языковой префикс в имени файла
- `storage_provider` - hostinger
- `file_name` - имя файла (объединение r2_object_key и hostinger_file_key)

### Вопросы
Для каждого эпизода создаются 3 базовых вопроса:
- Основная тема эпизода
- Что узнали из эпизода
- Мнение об эпизоде

## Использование

### Просмотр файлов
1. Открой страницу миграции
2. Нажми "Показать все файлы" для загрузки списка из FTP
3. Используйте поле "Конкретные даты" для фильтрации по датам
4. Просмотрите статистику: количество файлов и уникальных дат

### Миграция файлов
1. Нажми "Сканировать файлы" для поиска файлов для миграции
2. Система автоматически проанализирует длительность файлов
3. Проверьте найденные файлы в списке
4. Нажми "Начать миграцию" для добавления в базу данных

### Фильтрация по датам
- Введите даты через запятую: `2024-01-15, 2024-02-15, 2024-03-15`
- Оставьте поле пустым для показа всех файлов
- Используйте кнопку "Очистить" для сброса фильтра

## API Endpoints
- `GET /api/hostinger-list-files` - получение списка файлов с FTP

## Переменные окружения
Нужны те же переменные, что и для других Hostinger API:
- `HOSTINGER_SFTP_HOST`
- `HOSTINGER_SFTP_PORT`
- `HOSTINGER_SFTP_USERNAME`
- `HOSTINGER_SFTP_PASSWORD`
- `HOSTINGER_SFTP_UPLOAD_PATH`
- `HOSTINGER_PUBLIC_URL`
